{"ast":null,"code":"import _regeneratorRuntime from\"/Users/aniketsindhu/Documents/React projects/crowdfunding_tezos_dapp/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/aniketsindhu/Documents/React projects/crowdfunding_tezos_dapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect}from\"react\";import{BeaconWallet}from\"@taquito/beacon-wallet\";import{jsx as _jsx}from\"react/jsx-runtime\";function ConnectButton(_ref){var Tezos=_ref.Tezos,setWallet=_ref.setWallet,setUserAddress=_ref.setUserAddress,setUserBalance=_ref.setUserBalance,setBeaconConnection=_ref.setBeaconConnection,wallet=_ref.wallet;var setup=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userAddress){var balance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setUserAddress(userAddress);// updates balance\n_context.next=3;return Tezos.tz.getBalance(userAddress);case 3:balance=_context.sent;setUserBalance(balance.toNumber());//console.log(\"balance\", balance.toNumber());\ncase 5:case\"end\":return _context.stop();}}},_callee);}));return function setup(_x){return _ref2.apply(this,arguments);};}();var connectWallet=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var userAddress;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;console.log(\"connecting wallet\",wallet);_context2.next=4;return wallet.requestPermissions({network:{type:\"hangzhounet\"}});case 4:_context2.next=6;return wallet.getPKH();case 6:userAddress=_context2.sent;_context2.next=9;return setup(userAddress);case 9:setBeaconConnection(true);_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[0,12]]);}));return function connectWallet(){return _ref3.apply(this,arguments);};}();useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var options,wallet,activeAccount,userAddress;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Called\");// creates a wallet instance\noptions={name:\"Crowdfunding Dapp\",iconUrl:\"https://tezostaquito.io/img/favicon.png\",preferredNetwork:\"hangzhounet\"};wallet=new BeaconWallet(options,{name:\"Crowdfunding Dapp\",preferredNetwork:\"hangzhounet\",disableDefaultEvents:true});Tezos.setWalletProvider(wallet);setWallet(wallet);// checks if wallet was connected before\n_context3.next=7;return wallet.client.getActiveAccount();case 7:activeAccount=_context3.sent;if(!activeAccount){_context3.next=16;break;}console.log(activeAccount);_context3.next=12;return wallet.getPKH();case 12:userAddress=_context3.sent;_context3.next=15;return setup(userAddress);case 15:setBeaconConnection(true);case 16:case\"end\":return _context3.stop();}}},_callee3);}))();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{style:{margin:\"20px 10px 10px 10px\",backgroundColor:\"#1976D2\",color:\"white\",border:\"none\",cursor:\"pointer\",padding:\"10px 20px\"},onClick:connectWallet,children:/*#__PURE__*/_jsx(\"b\",{children:\"Connect Wallet\"})})});}export default ConnectButton;","map":{"version":3,"sources":["/Users/aniketsindhu/Documents/React projects/crowdfunding_tezos_dapp/src/components/Wallet/ConnectButton.jsx"],"names":["React","useEffect","BeaconWallet","ConnectButton","Tezos","setWallet","setUserAddress","setUserBalance","setBeaconConnection","wallet","setup","userAddress","tz","getBalance","balance","toNumber","connectWallet","console","log","requestPermissions","network","type","getPKH","options","name","iconUrl","preferredNetwork","disableDefaultEvents","setWalletProvider","client","getActiveAccount","activeAccount","margin","backgroundColor","color","border","cursor","padding"],"mappings":"2SAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,YAAT,KAA6B,wBAA7B,C,2CACA,QAASC,CAAAA,aAAT,MAOG,IANDC,CAAAA,KAMC,MANDA,KAMC,CALDC,SAKC,MALDA,SAKC,CAJDC,cAIC,MAJDA,cAIC,CAHDC,cAGC,MAHDA,cAGC,CAFDC,mBAEC,MAFDA,mBAEC,CADDC,MACC,MADDA,MACC,CACD,GAAMC,CAAAA,KAAK,2FAAG,iBAAOC,WAAP,8HACZL,cAAc,CAACK,WAAD,CAAd,CACA;AAFY,sBAGUP,CAAAA,KAAK,CAACQ,EAAN,CAASC,UAAT,CAAoBF,WAApB,CAHV,QAGNG,OAHM,eAIZP,cAAc,CAACO,OAAO,CAACC,QAAR,EAAD,CAAd,CACA;AALY,sDAAH,kBAALL,CAAAA,KAAK,6CAAX,CAQA,GAAMM,CAAAA,aAAa,2FAAG,yKAElBC,OAAO,CAACC,GAAR,CAAY,mBAAZ,CAAiCT,MAAjC,EAFkB,uBAGZA,CAAAA,MAAM,CAACU,kBAAP,CAA0B,CAC9BC,OAAO,CAAE,CACPC,IAAI,CAAE,aADC,CADqB,CAA1B,CAHY,+BAUQZ,CAAAA,MAAM,CAACa,MAAP,EAVR,QAUZX,WAVY,uCAYZD,CAAAA,KAAK,CAACC,WAAD,CAZO,QAalBH,mBAAmB,CAAC,IAAD,CAAnB,CAbkB,qFAelBS,OAAO,CAACC,GAAR,eAfkB,uEAAH,kBAAbF,CAAAA,aAAa,2CAAnB,CAkBAf,SAAS,CAAC,UAAM,CACd,wDAAC,qLACCgB,OAAO,CAACC,GAAR,CAAY,QAAZ,EACA;AACMK,OAHP,CAGiB,CACdC,IAAI,CAAE,mBADQ,CAEdC,OAAO,CAAE,yCAFK,CAGdC,gBAAgB,CAAE,aAHJ,CAHjB,CAQOjB,MARP,CAQgB,GAAIP,CAAAA,YAAJ,CAAiBqB,OAAjB,CAA0B,CACvCC,IAAI,CAAE,mBADiC,CAEvCE,gBAAgB,CAAE,aAFqB,CAGvCC,oBAAoB,CAAE,IAHiB,CAA1B,CARhB,CAaCvB,KAAK,CAACwB,iBAAN,CAAwBnB,MAAxB,EACAJ,SAAS,CAACI,MAAD,CAAT,CACA;AAfD,uBAgB6BA,CAAAA,MAAM,CAACoB,MAAP,CAAcC,gBAAd,EAhB7B,QAgBOC,aAhBP,oBAiBKA,aAjBL,2BAkBGd,OAAO,CAACC,GAAR,CAAYa,aAAZ,EAlBH,wBAmB6BtB,CAAAA,MAAM,CAACa,MAAP,EAnB7B,SAmBSX,WAnBT,wCAoBSD,CAAAA,KAAK,CAACC,WAAD,CApBd,SAqBGH,mBAAmB,CAAC,IAAD,CAAnB,CArBH,yDAAD,KAwBA;AACD,CA1BQ,CA0BN,EA1BM,CAAT,CA2BA,mBACE,kCACE,eACE,KAAK,CAAE,CACLwB,MAAM,CAAE,qBADH,CAELC,eAAe,CAAE,SAFZ,CAGLC,KAAK,CAAE,OAHF,CAILC,MAAM,CAAE,MAJH,CAKLC,MAAM,CAAE,SALH,CAMLC,OAAO,CAAE,WANJ,CADT,CASE,OAAO,CAAErB,aATX,uBAWE,qCAXF,EADF,EADF,CAiBD,CAED,cAAeb,CAAAA,aAAf","sourcesContent":["import React, { useEffect } from \"react\";\nimport { BeaconWallet } from \"@taquito/beacon-wallet\";\nfunction ConnectButton({\n  Tezos,\n  setWallet,\n  setUserAddress,\n  setUserBalance,\n  setBeaconConnection,\n  wallet,\n}) {\n  const setup = async (userAddress) => {\n    setUserAddress(userAddress);\n    // updates balance\n    const balance = await Tezos.tz.getBalance(userAddress);\n    setUserBalance(balance.toNumber());\n    //console.log(\"balance\", balance.toNumber());\n  };\n\n  const connectWallet = async () => {\n    try {\n      console.log(\"connecting wallet\", wallet);\n      await wallet.requestPermissions({\n        network: {\n          type: \"hangzhounet\",\n        },\n      });\n      // gets user's address\n      //console.log(\"connecting wallet\");\n      const userAddress = await wallet.getPKH();\n      //console.log(\"userAddress\", userAddress);\n      await setup(userAddress);\n      setBeaconConnection(true);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useEffect(() => {\n    (async () => {\n      console.log(\"Called\");\n      // creates a wallet instance\n      const options = {\n        name: \"Crowdfunding Dapp\",\n        iconUrl: \"https://tezostaquito.io/img/favicon.png\",\n        preferredNetwork: \"hangzhounet\",\n      };\n      const wallet = new BeaconWallet(options, {\n        name: \"Crowdfunding Dapp\",\n        preferredNetwork: \"hangzhounet\",\n        disableDefaultEvents: true,\n      });\n      Tezos.setWalletProvider(wallet);\n      setWallet(wallet);\n      // checks if wallet was connected before\n      const activeAccount = await wallet.client.getActiveAccount();\n      if (activeAccount) {\n        console.log(activeAccount);\n        const userAddress = await wallet.getPKH();\n        await setup(userAddress);\n        setBeaconConnection(true);\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return (\n    <div>\n      <button\n        style={{\n          margin: \"20px 10px 10px 10px\",\n          backgroundColor: \"#1976D2\",\n          color: \"white\",\n          border: \"none\",\n          cursor: \"pointer\",\n          padding: \"10px 20px\",\n        }}\n        onClick={connectWallet}\n      >\n        <b>Connect Wallet</b>\n      </button>\n    </div>\n  );\n}\n\nexport default ConnectButton;\n"]},"metadata":{},"sourceType":"module"}