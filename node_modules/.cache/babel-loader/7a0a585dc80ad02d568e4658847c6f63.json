{"ast":null,"code":"var _jsxFileName = \"/Users/aniketsindhu/Documents/React projects/crowdfunding_tezos_dapp/src/components/ProjectOngoing.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport ProgressBar from \"@ramonak/react-progress-bar\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport config from \"../config/config\";\nimport LoadingButton from \"@mui/lab/LoadingButton\";\nimport { Chip } from \"@mui/material\";\n/**\n * @param {{Tezos: TezosToolkit}}\n */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ProjectOngoing({\n  projectDetails,\n  Tezos,\n  userAddress\n}) {\n  _s();\n\n  const [fundingList, setProjectFunding] = useState(null);\n  const [contractBalance, setContractBalance] = useState(0);\n  const [amountToFund, setAmountToFund] = useState(0);\n  const [loading1, setLoading1] = useState(false);\n  const [loading2, setLoading2] = useState(false);\n  const [loading3, setLoading3] = useState(false);\n\n  const handleAmountToFundChange = event => {\n    setAmountToFund(event.target.value);\n  };\n\n  const addFund = () => {\n    setLoading1(true);\n    Tezos.wallet.at(projectDetails.address).then(contract => {\n      console.log(contract.entrypoints);\n\n      try {\n        contract.methods.send_fund().send({\n          amount: parseFloat(amountToFund) * 10 ** 6,\n          mutez: true\n        }).then(op => {\n          return op.confirmation();\n        }).then(result => {\n          if (result.completed) {\n            setLoading1(false);\n            axios.get(config.API_URL_Project + projectDetails.address).then(response => {\n              setContractBalance(response.data.balance);\n            });\n            axios.get(config.API_URL_Project + projectDetails.address + \"/storage\").then(response => {\n              setProjectFunding(response.data.funding);\n            });\n          }\n        });\n      } catch (e) {\n        console.log(e);\n        setLoading1(false);\n      }\n    });\n  };\n\n  const withdraw = () => {\n    setLoading2(true);\n    Tezos.wallet.at(projectDetails.address).then(contract => {\n      console.log(contract.entrypoints);\n\n      try {\n        contract.methods.refund().send().then(op => {\n          return op.confirmation();\n        }).then(result => {\n          if (result.completed) {\n            setLoading2(false);\n            axios.get(config.API_URL_Project + projectDetails.address).then(response => {\n              setContractBalance(response.data.balance);\n            });\n            axios.get(config.API_URL_Project + projectDetails.address + \"/storage\").then(response => {\n              setProjectFunding(response.data.funding);\n            });\n          }\n        });\n      } catch (e) {\n        console.log(e);\n        setLoading2(false);\n      }\n    });\n  };\n\n  const claim = () => {\n    setLoading3(true);\n    Tezos.wallet.at(projectDetails.address).then(contract => {\n      console.log(contract.entrypoints);\n\n      try {\n        contract.methods.pay_off().send().then(op => {\n          return op.confirmation();\n        }).then(result => {\n          if (result.completed) {\n            setLoading3(false);\n            axios.get(config.API_URL_Project + projectDetails.address).then(response => {\n              setContractBalance(response.data.balance);\n            });\n            axios.get(config.API_URL_Project + projectDetails.address + \"/storage\").then(response => {\n              setProjectFunding(response.data.funding);\n            });\n          }\n        });\n      } catch (e) {\n        console.log(e);\n        setLoading3(false);\n      }\n    });\n  };\n\n  useEffect(() => {\n    const getProjectInfo = () => {\n      console.log(config.API_URL_Project + projectDetails.address + \"/storage\");\n      axios.get(config.API_URL_Project + projectDetails.address + \"/storage\").then(response => {\n        setProjectFunding(response.data.funding);\n      });\n      axios.get(config.API_URL_Project + projectDetails.address).then(response => {\n        setContractBalance(response.data.balance);\n      });\n    };\n\n    getProjectInfo();\n  }, [projectDetails.address]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: \"250px\",\n      width: \"100%\",\n      padding: \"15px\",\n      backgroundColor: \"white\",\n      boxShadow: \"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"start\",\n      marginBottom: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems: \"center\"\n      },\n      children: [new Date(projectDetails.data.endTime) > Date.now() ? /*#__PURE__*/_jsxDEV(Chip, {\n        style: {\n          backgroundColor: \"#1976D2\",\n          marginRight: \"15px\",\n          color: \"white\"\n        },\n        label: \"Ongoing\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }, this) : contractBalance >= projectDetails.data.goalAmount ? /*#__PURE__*/_jsxDEV(Chip, {\n        style: {\n          backgroundColor: \"#19D266\",\n          marginRight: \"15px\",\n          color: \"white\"\n        },\n        label: \"Ended Successfully\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Chip, {\n        style: {\n          backgroundColor: \"#D21932\",\n          marginRight: \"15px\",\n          color: \"white\"\n        },\n        label: \"Failed\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          margin: 0\n        },\n        children: projectDetails.data.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: \"10px 0px 10px 0px\"\n      },\n      children: projectDetails.data.description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: \"10px 0px 10px 0px\"\n      },\n      children: [\"Time: \", new Date(projectDetails.data.endTime).toUTCString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: \"10px 0px 15px 0px\"\n      },\n      children: [\"Funded \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: [contractBalance / 10 ** 6, \" Tez\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 16\n      }, this), \" out of goal of\", \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: [projectDetails.data.goalAmount / 10 ** 6, \" Tez\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        flexDirection: \"row\"\n      },\n      children: [new Date(projectDetails.data.endTime) > Date.now() && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          onChange: handleAmountToFundChange,\n          placeholder: \"Amount in Tez\",\n          style: {\n            padding: \"6px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(LoadingButton, {\n          loading: loading1,\n          onClick: addFund,\n          variant: \"contained\",\n          style: {\n            margin: \"0px 10px 0px 10px\"\n          },\n          children: \"Fund Project\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this), fundingList && fundingList.hasOwnProperty(userAddress) && /*#__PURE__*/_jsxDEV(LoadingButton, {\n        loading: loading2,\n        onClick: withdraw,\n        variant: \"contained\",\n        style: {\n          margin: \"0px 10px 0px 10px\"\n        },\n        children: [\"Withdraw \", fundingList[userAddress] / 10 ** 6, \" Tez\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 11\n      }, this), projectDetails.data.owner === userAddress && contractBalance >= projectDetails.data.goalAmount && new Date(projectDetails.data.endTime) < Date.now() && /*#__PURE__*/_jsxDEV(LoadingButton, {\n        loading: loading3,\n        onClick: claim,\n        variant: \"contained\",\n        style: {\n          margin: \"0px 10px 0px 10px\"\n        },\n        children: \"Claim Funds\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"20px\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        width: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"0 Tez\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ProgressBar, {\n        completed: contractBalance / projectDetails.data.goalAmount * 100,\n        customLabel: ` ${contractBalance / 10 ** 6} Tez`,\n        margin: \"10px\",\n        width: \"55rem\",\n        bgColor: \"#1976D2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n        children: [projectDetails.data.goalAmount / 10 ** 6, \" Tez\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProjectOngoing, \"U4aECzHos+8f6iugwQvUCNUNVvU=\");\n\n_c = ProjectOngoing;\nexport default ProjectOngoing;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProjectOngoing\");","map":{"version":3,"sources":["/Users/aniketsindhu/Documents/React projects/crowdfunding_tezos_dapp/src/components/ProjectOngoing.jsx"],"names":["React","ProgressBar","useState","useEffect","axios","config","LoadingButton","Chip","ProjectOngoing","projectDetails","Tezos","userAddress","fundingList","setProjectFunding","contractBalance","setContractBalance","amountToFund","setAmountToFund","loading1","setLoading1","loading2","setLoading2","loading3","setLoading3","handleAmountToFundChange","event","target","value","addFund","wallet","at","address","then","contract","console","log","entrypoints","methods","send_fund","send","amount","parseFloat","mutez","op","confirmation","result","completed","get","API_URL_Project","response","data","balance","funding","e","withdraw","refund","claim","pay_off","getProjectInfo","height","width","padding","backgroundColor","boxShadow","display","flexDirection","alignItems","marginBottom","Date","endTime","now","marginRight","color","goalAmount","margin","name","description","toUTCString","hasOwnProperty","owner","marginTop","justifyContent"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ProgressBar from \"@ramonak/react-progress-bar\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport config from \"../config/config\";\nimport LoadingButton from \"@mui/lab/LoadingButton\";\nimport { Chip } from \"@mui/material\";\n\n/**\n * @param {{Tezos: TezosToolkit}}\n */\nfunction ProjectOngoing({ projectDetails, Tezos, userAddress }) {\n  const [fundingList, setProjectFunding] = useState(null);\n  const [contractBalance, setContractBalance] = useState(0);\n  const [amountToFund, setAmountToFund] = useState(0);\n  const [loading1, setLoading1] = useState(false);\n  const [loading2, setLoading2] = useState(false);\n  const [loading3, setLoading3] = useState(false);\n  const handleAmountToFundChange = (event) => {\n    setAmountToFund(event.target.value);\n  };\n\n  const addFund = () => {\n    setLoading1(true);\n    Tezos.wallet.at(projectDetails.address).then((contract) => {\n      console.log(contract.entrypoints);\n      try {\n        contract.methods\n          .send_fund()\n          .send({ amount: parseFloat(amountToFund) * 10 ** 6, mutez: true })\n          .then((op) => {\n            return op.confirmation();\n          })\n          .then((result) => {\n            if (result.completed) {\n              setLoading1(false);\n              axios\n                .get(config.API_URL_Project + projectDetails.address)\n                .then((response) => {\n                  setContractBalance(response.data.balance);\n                });\n              axios\n                .get(\n                  config.API_URL_Project + projectDetails.address + \"/storage\"\n                )\n                .then((response) => {\n                  setProjectFunding(response.data.funding);\n                });\n            }\n          });\n      } catch (e) {\n        console.log(e);\n        setLoading1(false);\n      }\n    });\n  };\n\n  const withdraw = () => {\n    setLoading2(true);\n    Tezos.wallet.at(projectDetails.address).then((contract) => {\n      console.log(contract.entrypoints);\n      try {\n        contract.methods\n          .refund()\n          .send()\n          .then((op) => {\n            return op.confirmation();\n          })\n          .then((result) => {\n            if (result.completed) {\n              setLoading2(false);\n              axios\n                .get(config.API_URL_Project + projectDetails.address)\n                .then((response) => {\n                  setContractBalance(response.data.balance);\n                });\n              axios\n                .get(\n                  config.API_URL_Project + projectDetails.address + \"/storage\"\n                )\n                .then((response) => {\n                  setProjectFunding(response.data.funding);\n                });\n            }\n          });\n      } catch (e) {\n        console.log(e);\n        setLoading2(false);\n      }\n    });\n  };\n\n  const claim = () => {\n    setLoading3(true);\n    Tezos.wallet.at(projectDetails.address).then((contract) => {\n      console.log(contract.entrypoints);\n      try {\n        contract.methods\n          .pay_off()\n          .send()\n          .then((op) => {\n            return op.confirmation();\n          })\n          .then((result) => {\n            if (result.completed) {\n              setLoading3(false);\n              axios\n                .get(config.API_URL_Project + projectDetails.address)\n                .then((response) => {\n                  setContractBalance(response.data.balance);\n                });\n              axios\n                .get(\n                  config.API_URL_Project + projectDetails.address + \"/storage\"\n                )\n                .then((response) => {\n                  setProjectFunding(response.data.funding);\n                });\n            }\n          });\n      } catch (e) {\n        console.log(e);\n        setLoading3(false);\n      }\n    });\n  };\n\n  useEffect(() => {\n    const getProjectInfo = () => {\n      console.log(config.API_URL_Project + projectDetails.address + \"/storage\");\n      axios\n        .get(config.API_URL_Project + projectDetails.address + \"/storage\")\n        .then((response) => {\n          setProjectFunding(response.data.funding);\n        });\n      axios\n        .get(config.API_URL_Project + projectDetails.address)\n        .then((response) => {\n          setContractBalance(response.data.balance);\n        });\n    };\n    getProjectInfo();\n  }, [projectDetails.address]);\n\n  return (\n    <div\n      style={{\n        height: \"250px\",\n        width: \"100%\",\n        padding: \"15px\",\n        backgroundColor: \"white\",\n        boxShadow:\n          \"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"start\",\n        marginBottom: \"20px\",\n      }}\n    >\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          alignItems: \"center\",\n        }}\n      >\n        {new Date(projectDetails.data.endTime) > Date.now() ? (\n          <Chip\n            style={{\n              backgroundColor: \"#1976D2\",\n              marginRight: \"15px\",\n              color: \"white\",\n            }}\n            label=\"Ongoing\"\n          />\n        ) : contractBalance >= projectDetails.data.goalAmount ? (\n          <Chip\n            style={{\n              backgroundColor: \"#19D266\",\n              marginRight: \"15px\",\n              color: \"white\",\n            }}\n            label=\"Ended Successfully\"\n          />\n        ) : (\n          <Chip\n            style={{\n              backgroundColor: \"#D21932\",\n              marginRight: \"15px\",\n              color: \"white\",\n            }}\n            label=\"Failed\"\n          />\n        )}\n\n        <h2 style={{ margin: 0 }}>{projectDetails.data.name}</h2>\n      </div>\n      <div style={{ margin: \"10px 0px 10px 0px\" }}>\n        {projectDetails.data.description}\n      </div>\n      <div style={{ margin: \"10px 0px 10px 0px\" }}>\n        Time: {new Date(projectDetails.data.endTime).toUTCString()}\n      </div>\n      <div style={{ margin: \"10px 0px 15px 0px\" }}>\n        Funded <b>{contractBalance / 10 ** 6} Tez</b> out of goal of{\" \"}\n        <b>{projectDetails.data.goalAmount / 10 ** 6} Tez</b>\n      </div>\n\n      <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n        {new Date(projectDetails.data.endTime) > Date.now() && (\n          <div>\n            <input\n              type=\"text\"\n              onChange={handleAmountToFundChange}\n              placeholder=\"Amount in Tez\"\n              style={{ padding: \"6px\" }}\n            />\n            <LoadingButton\n              loading={loading1}\n              onClick={addFund}\n              variant=\"contained\"\n              style={{\n                margin: \"0px 10px 0px 10px\",\n              }}\n            >\n              Fund Project\n            </LoadingButton>\n          </div>\n        )}\n\n        {fundingList && fundingList.hasOwnProperty(userAddress) && (\n          <LoadingButton\n            loading={loading2}\n            onClick={withdraw}\n            variant=\"contained\"\n            style={{\n              margin: \"0px 10px 0px 10px\",\n            }}\n          >\n            Withdraw {fundingList[userAddress] / 10 ** 6} Tez\n          </LoadingButton>\n        )}\n\n        {projectDetails.data.owner === userAddress &&\n          contractBalance >= projectDetails.data.goalAmount &&\n          new Date(projectDetails.data.endTime) < Date.now() && (\n            <LoadingButton\n              loading={loading3}\n              onClick={claim}\n              variant=\"contained\"\n              style={{\n                margin: \"0px 10px 0px 10px\",\n              }}\n            >\n              Claim Funds\n            </LoadingButton>\n          )}\n      </div>\n\n      <div\n        style={{\n          marginTop: \"20px\",\n          display: \"flex\",\n          flexDirection: \"row\",\n          alignItems: \"center\",\n          justifyContent: \"space-between\",\n          width: \"100%\",\n        }}\n      >\n        <b>0 Tez</b>\n        <ProgressBar\n          completed={(contractBalance / projectDetails.data.goalAmount) * 100}\n          customLabel={` ${contractBalance / 10 ** 6} Tez`}\n          margin=\"10px\"\n          width=\"55rem\"\n          bgColor=\"#1976D2\"\n        />\n        <b>{projectDetails.data.goalAmount / 10 ** 6} Tez</b>\n      </div>\n    </div>\n  );\n}\n\nexport default ProjectOngoing;\n"]},"metadata":{},"sourceType":"module"}